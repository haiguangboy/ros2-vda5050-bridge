# å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸš€ 3æ­¥å¯åŠ¨å®Œæ•´ç³»ç»Ÿ

### æ­¥éª¤1: å¯åŠ¨MQTT Bridgeï¼ˆå¿…é¡»ï¼ï¼‰

```bash
cd /home/yhg/Documents/ep-embodied/mqtt_bridge/tests/planner
./start_mqtt_bridge.sh
```

**æœŸæœ›è¾“å‡ºï¼š**
```
==================================
ğŸš€ å¯åŠ¨MQTT Bridge
==================================
âœ… å¯æ‰§è¡Œæ–‡ä»¶: /home/yhg/Documents/ep-embodied/mqtt_bridge/install/bin/zhongli_bridge_node
âœ… é…ç½®æ–‡ä»¶: /home/yhg/Documents/ep-embodied/mqtt_bridge/config/bridge_config.yaml

ğŸ“¦ åŠ è½½ROS2ç¯å¢ƒ...
ğŸ”Œ å¯åŠ¨MQTT Bridge...
   (æŒ‰ Ctrl+C åœæ­¢)

âœ… ä¸­åŠ›MQTTå®¢æˆ·ç«¯å·²åˆ›å»º - Robot ID: robot-001
ğŸ”Œ æ­£åœ¨è¿æ¥åˆ°EMQXæœåŠ¡å™¨: localhost:1883
âœ… å·²è¿æ¥åˆ°EMQXæœåŠ¡å™¨
ğŸ“¡ å·²è®¢é˜…ä¸»é¢˜: EP/master/robot-001/task
```

âš ï¸ **ä¿æŒè¿™ä¸ªç»ˆç«¯è¿è¡Œï¼**

---

### æ­¥éª¤2: å¯åŠ¨è½¨è¿¹è§„åˆ’èŠ‚ç‚¹

**æ–°å¼€ç»ˆç«¯2ï¼š**
```bash
cd /home/yhg/Documents/ep-embodied/mqtt_bridge/tests/planner
python3 test_beta4_trajectory_workflow_goal.py
```

**æœŸæœ›è¾“å‡ºï¼š**
```
ğŸ§ª åŸºäºç›®æ ‡ç‚¹çš„è½¨è¿¹è§„åˆ’å·¥ä½œæµç¨‹æµ‹è¯•
ğŸš€ è¿æ¥åˆ°MQTTä»£ç†: localhost:1883
âœ… MQTTè¿æ¥æˆåŠŸ
ğŸ“¡ è®¢é˜…è½¨è¿¹çŠ¶æ€ä¸»é¢˜: EP/robot-001/cerebellum/embrain/trajectory_status

â³ ç­‰å¾… /Odom è¯é¢˜æ•°æ®ï¼ˆæœ€å¤šç­‰å¾… 10 ç§’ï¼‰...
âš ï¸  10ç§’å†…æœªæ”¶åˆ° /Odom è¯é¢˜ï¼Œä½¿ç”¨é»˜è®¤ä½ç½®æ•°æ®
   é»˜è®¤ä½ç½®: (0.000, 0.000), æœå‘: 0.0Â°

â³ ç­‰å¾…ç›®æ ‡ç‚¹ /nav_goal è¯é¢˜æ•°æ®...
   æ— è¶…æ—¶é™åˆ¶ï¼ˆæŒ‰Ctrl+Cå¯ä¸­æ–­ï¼‰
```

âš ï¸ **ä¿æŒè¿™ä¸ªç»ˆç«¯è¿è¡Œï¼Œç­‰å¾…ç›®æ ‡ç‚¹ï¼**

---

### æ­¥éª¤3: å‘å¸ƒç›®æ ‡ç‚¹

**æ–°å¼€ç»ˆç«¯3ï¼š**
```bash
cd /home/yhg/Documents/ep-embodied/mqtt_bridge/tests/planner
python3 publish_goal.py --x 3.0 --y 0.0 --yaw 90
```

**æœŸæœ›è¾“å‡ºï¼š**
```
âœ… å‡†å¤‡å‘å¸ƒç›®æ ‡ç‚¹åˆ° /nav_goal:
   ä½ç½®: (3.000, 0.000)
   æœå‘: 90.0Â° (1.571 rad)
   å‘å¸ƒé¢‘ç‡: 10 Hzï¼ŒæŒç»­2ç§’

ğŸ“¤ å·²å‘å¸ƒ 5/20 æ¬¡...
ğŸ“¤ å·²å‘å¸ƒ 10/20 æ¬¡...
ğŸ“¤ å·²å‘å¸ƒ 15/20 æ¬¡...
ğŸ“¤ å·²å‘å¸ƒ 20/20 æ¬¡...
âœ… å·²å‘å¸ƒ 20 æ¬¡ï¼Œå®Œæˆ
```

---

### æœŸæœ›ç»“æœ

**ç»ˆç«¯2ï¼ˆè½¨è¿¹è§„åˆ’èŠ‚ç‚¹ï¼‰åº”è¯¥æ˜¾ç¤ºï¼š**
```
âœ… å·²æ¥æ”¶åˆ°ç›®æ ‡ç‚¹
   ç›®æ ‡ä½ç½®: (3.000, 0.000), æœå‘: 90.0Â°

ğŸ“¡ è·å–æœ€æ–°Odomæ•°æ®...

================================================================================
ğŸ“ è½¨è¿¹è§„åˆ’
================================================================================
èµ·ç‚¹: (0.000, 0.000), yaw=0.0Â°
ç»ˆç‚¹: (3.000, 0.000), yaw=90.0Â°

ğŸ“‹ è·¯å¾„è§„åˆ’å¼€å§‹:
   èµ·ç‚¹: (0.000, 0.000), yaw=0.000 (0.0Â°)
   ç»ˆç‚¹: (3.000, 0.000), yaw=1.571 (90.0Â°)
   ç›´çº¿è·ç¦»: 3.000m
   é˜¶æ®µ2: ç›´çº¿ç§»åŠ¨ 3.000m (ç‚¹é—´è·0.15m, 21ä¸ªç‚¹)
   é˜¶æ®µ3: åŸåœ°æ—‹è½¬ 90.0Â° åˆ°ç›®æ ‡æœå‘
   âœ… è§„åˆ’å®Œæˆ: å…± 23 ä¸ªè·¯å¾„ç‚¹

ğŸ“¤ è½¨è¿¹å·²å‘å¸ƒåˆ° /plans
ğŸ“‹ è½¨è¿¹ID: goal_traj_XXXXXXXXXX
ğŸ“ è·¯å¾„ç‚¹æ•°: 23

â³ ç­‰å¾…MQTTè½¨è¿¹å®Œæˆä¿¡å·ï¼ˆæŒ‰Ctrl+Cå¯ä¸­æ–­ï¼‰...
```

**ç»ˆç«¯1ï¼ˆMQTT Bridgeï¼‰åº”è¯¥æ˜¾ç¤ºï¼š**
```
ğŸ“¤ å‘å¸ƒè½¨è¿¹æŒ‡ä»¤åˆ°: EP/robot-001/embrain/cerebellum/trajectory
   è½¨è¿¹ID: goal_traj_XXXXXXXXXX
   è½¨è¿¹ç‚¹æ•°: 23
```

---

## ğŸ” éªŒè¯çŠ¶æ€æŸ¥è¯¢

**æ–°å¼€ç»ˆç«¯4ï¼š**
```bash
cd /home/yhg/Documents/ep-embodied/mqtt_bridge/tests/planner
python3 query_trajectory_status.py
```

**å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œåº”è¯¥çœ‹åˆ°ï¼š**
```
ğŸ“ è°ƒç”¨ /trajectory_status service...

================================================================================
ğŸ“Š è½¨è¿¹çŠ¶æ€æŸ¥è¯¢ç»“æœ
================================================================================
âœ… æŸ¥è¯¢æˆåŠŸ

çŠ¶æ€ä¿¡æ¯:
  è½¨è¿¹ID: goal_traj_XXXXXXXXXX
  çŠ¶æ€: running/completed
  æ—¶é—´æˆ³: XXXXXXXXXX
  æ¶ˆæ¯: ...

âœ… è½¨è¿¹å·²å®Œæˆï¼ˆæˆ–å…¶ä»–çŠ¶æ€ï¼‰
================================================================================
```

---

## âŒ æ•…éšœæ’æŸ¥

### é—®é¢˜: æŸ¥è¯¢çŠ¶æ€è¿”å› no_data

**æ£€æŸ¥MQTT Bridgeæ˜¯å¦è¿è¡Œï¼š**
```bash
ps aux | grep zhongli_bridge_node | grep -v grep
```

å¦‚æœæ²¡æœ‰è¾“å‡º â†’ **å›åˆ°æ­¥éª¤1å¯åŠ¨MQTT Bridge**

### é—®é¢˜: è½¨è¿¹è§„åˆ’èŠ‚ç‚¹æ²¡æ”¶åˆ°ç›®æ ‡ç‚¹

**æ£€æŸ¥è¯é¢˜è¿æ¥ï¼š**
```bash
ros2 topic list | grep nav_goal
ros2 topic info /nav_goal
```

åº”è¯¥çœ‹åˆ°æœ‰1ä¸ªå‘å¸ƒè€…å’Œ1ä¸ªè®¢é˜…è€…ã€‚

### é—®é¢˜: MQTTè¿æ¥å¤±è´¥

**æ£€æŸ¥EMQXæ˜¯å¦è¿è¡Œï¼š**
```bash
systemctl status emqx
# æˆ–
netstat -tuln | grep 1883
```

å¦‚æœæ²¡è¿è¡Œï¼š
```bash
sudo systemctl start emqx
```

---

## ğŸ› ï¸ å®Œæ•´è¯Šæ–­

å¦‚æœä»¥ä¸Šéƒ½ä¸è¡Œï¼Œè¿è¡Œè¯Šæ–­å·¥å…·ï¼š

```bash
cd /home/yhg/Documents/ep-embodied/mqtt_bridge/tests/planner
python3 diagnose_mqtt.py
```

ç„¶ååœ¨å¦ä¸€ä¸ªç»ˆç«¯é‡å¤æ­¥éª¤2-3ï¼Œè§‚å¯Ÿè¯Šæ–­è¾“å‡ºã€‚

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å¿…é¡»æŒ‰é¡ºåºå¯åŠ¨**ï¼šBridge â†’ è§„åˆ’èŠ‚ç‚¹ â†’ å‘å¸ƒç›®æ ‡ç‚¹
2. **MQTT Bridgeå¿…é¡»è¿è¡Œ**ï¼šå¦åˆ™è½¨è¿¹æ— æ³•è½¬å‘åˆ°åº•å±‚
3. **å‘å¸ƒå™¨ä¼šè‡ªåŠ¨é€€å‡º**ï¼šå‘å¸ƒ20æ¬¡ï¼ˆ2ç§’ï¼‰åè‡ªåŠ¨ç»“æŸ
4. **é»˜è®¤ä½¿ç”¨localhost**ï¼šå¦‚æœEMQXåœ¨å…¶ä»–æœºå™¨ï¼Œä¿®æ”¹é…ç½®
